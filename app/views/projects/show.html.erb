<h3>NOTE FROM DUSTIN: This currently uses the _project partial as a placeholder it should be changed</h3>
<div class="jumbotron">
  <h1 class="display-4"> <%= @project.title %></h1>
  <p class="lead">
    <div class = "row">
      <div class = "col-4">
        <p> Category: <%= @project.category %></p>
        <p> Estimated Time: <%= @project.estimated_time %> </p>
        <p>Max People: <%= @project.max_people %> </p>
        <p>location: <%= @project.location %> </p>
      </div>
      <div id="carouselExampleControls" class="carousel slide" data-ride="carousel" style="width: 500px; margin: 0 auto">
        <div class="carousel-inner">
          <% @project.images.each_with_index do |img , index|  %>
            <div class="carousel-item <%= index == 0 ? 'active' : nil %>">
              <%=image_tag img.url(:thumb).to_s, :class => "img-thumbnail image" %>
            </div>
          <% end %>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
    </p>
  </div>
  <hr class="my-4">
  <p>latitude: <%= @project.latitude %> </p>
  <p>longitude: <%= @project.longitude %> </p>
  <p>Poster: <%= @project.user.first_name %> </p>
</div>
<%if signed_in?%>
  <%if current_user.id == @project.user_id || current_user.moderator? || current_user.superadmin?%>
    <%if @project.is_complete == false%>
      <%= link_to 'Mark as Complete', complete_project_path(@project.id), method: :patch%>
      <%= link_to 'Edit', edit_project_path(@project) %>
      <%= link_to 'Delete', project_path(@project),
                        method: :delete,
                        data: {confirm: 'Sure?'}%>
      <h1> Pending Volunteers: </h1>
      <%= render partial: 'users/volunteer', collection: @pending, as: :response%>
    <%end%>
    <h1> Approved Volunteers: </h1>
    <%= render partial: 'users/volunteer', collection: @approved, as: :response%>
  <%else%>
    <%if @responses.find_by(user_id: current_user.id).nil? && @project.is_complete == false%>
      <%=link_to "Volunteer!", response_path(@project.id), class: 'btn btn-primary' %>
    <%end%>
  <%end%>
<% end %>
<%= link_to 'Chat', rooms_show_path %>

<!-- Modal -->
<%@approved.each_with_index do |r|%>
  <div class="modal fade" id="ratingmodal-<%=r.user.id%>" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">

        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Rate <%=r.user.full_name%></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body">
          <%= render :partial => 'reviews/form', locals: {user_id: r.user.id} %>      
        </div>
      </div>
    </div>
  </div>
<% end %>

<script>
  $('#ratingmodal').on('show.bs.modal', function(e) {
    // No need to get project ID as it is already defined in controller method
    let user_id = $(e.relatedTarget).context.id;
    console.log(user_id)
  });
</script>